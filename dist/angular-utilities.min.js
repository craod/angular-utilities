!function(){"use strict";angular.module("angular-utilities",[])}(),function(){"use strict";function a(a){return{restrict:"E",scope:{object:"=",width:"@?",height:"@?",mode:"@?","class":"@?",type:"@?"},templateUrl:"templates/objectimage.html",link:function(b){b.resource=a}}}a.$inject=["Resource"],angular.module("angular-utilities").directive("objectImage",a)}(),function(){"use strict";function a(a){return{restrict:"A",scope:{object:"=",format:"@?",property:"@?",type:"@renderObject"},template:'<i data-ng-if="loading" class="fa fa-refresh fa-spin"></i> {{loading ? "" : (format ? (format | translate:entity) : entity[property])}}',link:function(b){if(b.object&&"object"==typeof b.object)b.entity=b.object;else{b.loading=!0;var c=b.type[0].toUpperCase()+b.type.substring(1)+"Service",d=a.get(c),e=d.get({},{guid:b.object});e.then(function(a){b.entity=a}),e["finally"](function(){delete b.loading})}}}}a.$inject=["$injector"],angular.module("angular-utilities").directive("renderObject",a)}(),function(){"use strict";function a(a,b){function c(a,b){b.sortBy&&(a.sortBy=b.sortBy,b.order&&(a.order=b.order))}function d(a,b){b.offset&&(a.offset=b.offset),b.limit&&(a.limit=b.limit)}function e(a,b){var c,d;if(b.filters)for(c in b.filters)d="filters["+c+"]",a[d]=b.filters[c]}function f(a,b){var c;for(c in b)a=a.replace(new RegExp(":"+c,"g"),b[c]);return a}function g(a){var b,c,d=a;if(arguments.length>1)for(c=1;c<arguments.length;c++)for(b in arguments[c])d+="_"+b+":"+arguments[c][b];return d}function h(h,i,j,k){h[i]=function(l,m,n){l=l||{},m=m||{},n=n||{};var o,p,q,r={},s=l.force;if(p=k.method?k.method:"get",k.pagination&&d(r,l),k.sorting&&c(r,l),k.filtering&&l.filters&&e(r,l),o=g(i,r,n,m),q=f(j,m),!k.cachable||!h.cachedPromises[o]||s){var t=b({method:p,url:q,params:r,data:n}),u=a.defer();t.then(function(a){var b={};b=k.pagination?{items:a.data.items,pagination:{offset:a.data.offset,limit:a.data.limit,total:a.data.total}}:a.data,u.resolve(b)},u.reject),h.cachedPromises[o]=u.promise}return h.cachedPromises[o]}}function i(a){var b,c,d=this;d.cachedPromises={},d.clearCache=function(a){var b;for(b in d.cachedPromises)0===b.indexOf(a)&&delete d.cachedPromises[b]},d.clearCaches=function(){d.cachedPromises={}};for(b in a)c=a[b],h(d,b,c.url,c)}return i}a.$inject=["$q","$http"],angular.module("angular-utilities").factory("CrudService",a)}(),function(){"use strict";function a(a,b){var c=this,d={count:{url:a.get("api.url")+"category/count",cachable:!0,filtering:!0},getAll:{url:a.get("api.url")+"category",cachable:!0,pagination:!0,filtering:!0,sorting:!0},getParents:{url:a.get("api.url")+"category/parents/:guid",cachable:!0,pagination:!0,filtering:!0,sorting:!0},getChildren:{url:a.get("api.url")+"category/children/:guid",cachable:!0,pagination:!0,filtering:!0,sorting:!0},getCategoriesInObject:{url:a.get("api.url")+"category/object/:guid",cachable:!0,pagination:!0,filtering:!0,sorting:!0},get:{url:a.get("api.url")+"category/:guid",cachable:!0},create:{url:a.get("api.url")+"category",method:"post"},update:{url:a.get("api.url")+"category/:guid",method:"put"},"delete":{url:a.get("api.url")+"category/:guid",method:"delete"},activate:{url:a.get("api.url")+"category/activate/:guid"},deactivate:{url:a.get("api.url")+"category/deactivate/:guid"},search:{url:a.get("api.url")+"category/search",method:"post",cachable:!0,pagination:!0,sorting:!0},autocomplete:{url:a.get("api.url")+"category/autocomplete/:query",method:"get",cachable:!0,pagination:!0,sorting:!1}};angular.extend(c,new b(d))}a.$inject=["Settings","CrudService"],angular.module("angular-utilities").service("CategoryService",a)}(),function(){"use strict";function a(a,b){var c=this,d={count:{url:a.get("api.url")+"object/count",cachable:!0,filtering:!0},getAll:{url:a.get("api.url")+"object",cachable:!0,pagination:!0,filtering:!0,sorting:!0},getObjectsInCategory:{url:a.get("api.url")+"object/category/:guid",cachable:!0,pagination:!0,filtering:!0,sorting:!0},get:{url:a.get("api.url")+"object/:guid",cachable:!0},create:{url:a.get("api.url")+"object",method:"post"},update:{url:a.get("api.url")+"object/:guid",method:"put"},"delete":{url:a.get("api.url")+"object/:guid",method:"delete"},activate:{url:a.get("api.url")+"object/activate/:guid"},deactivate:{url:a.get("api.url")+"object/deactivate/:guid"},search:{url:a.get("api.url")+"object/search",method:"post",cachable:!0,pagination:!0,sorting:!0}};angular.extend(c,new b(d))}a.$inject=["Settings","CrudService"],angular.module("angular-utilities").service("ObjectService",a)}(),function(){"use strict";function a(){function a(a){var c={};return c.data=angular.copy(b.data),c.isLoaded=function(){return!!c.initialized},c.load=function(){var d=a.get(b.endpoint);return c.initialized=!1,d.then(function(a){c.data=angular.extend(a.data,b.data)}),d["finally"](function(){c.initialized=!0}),d},c.settingExists=function(a){var b,d,e=a.split("."),f=angular.copy(c.data);for(b in e){if(d=e[b],!f.hasOwnProperty(d))return!1;f=f[d]}return!0},c.get=function(a,b){var d,e,f=a.split("."),g=angular.copy(c.data);for(d in f){if(e=f[d],!g.hasOwnProperty(e))return b;g=g[e]}return g},c}var b=this;b.data={},b.endpoint="",a.$inject=["$http"],b.$get=a}angular.module("angular-utilities").provider("Settings",a)}(),function(){"use strict";function a(a,b){var c=this,d={count:{url:a.get("api.url")+"user/count",cachable:!0,filtering:!0},getAll:{url:a.get("api.url")+"user",cachable:!0,pagination:!0,filtering:!0,sorting:!0},get:{url:a.get("api.url")+"user/:guid",cachable:!0},create:{url:a.get("api.url")+"user",method:"post"},update:{url:a.get("api.url")+"user/:guid",method:"put"},"delete":{url:a.get("api.url")+"user/:guid",method:"delete"},checkEmailAvailability:{url:a.get("api.url")+"user/available/:email",cachable:!0},changePassword:{url:a.get("api.url")+"user/password/change/:guid",method:"post"},resetPassword:{url:a.get("api.url")+"user/password/reset/:guid"},activate:{url:a.get("api.url")+"user/activate/:guid"},deactivate:{url:a.get("api.url")+"user/deactivate/:guid"},logOut:{url:a.get("api.url")+"user/logout/:guid"},search:{url:a.get("api.url")+"user/search",method:"post",cachable:!0,pagination:!0,sorting:!0},uploadProfilePicture:{url:a.get("api.url")+"user/image/:guid",method:"post"},deleteProfilePicture:{url:a.get("api.url")+"user/image/:guid",method:"delete"}};c.hasRole=function(a,b){return(a&b)===b},angular.extend(c,new b(d))}a.$inject=["Settings","CrudService"],angular.module("angular-utilities").service("UserService",a)}(),function(){"use strict";function a(a){var b={};return b.getExtensionByMimeType=function(a){var b=a.toLowerCase().split("/")[1];return"jpeg"==b&&(b="jpg"),b},b.getApproximateSize=function(a,b,c){var d,e,f,g,h,i,j;for(d in c)"watermarked"!=c[d]&&(g=c[d].split("-")[0].split("x"),e=g[0],f=g[1],h=Math.abs(a-e)+Math.abs(b-f),(void 0===i||i>h)&&(i=h,j=c[d]));return j},b.getPublicUrl=function(b){return a.get("storage.location")+"/"+b},b.getProfilePictureUrl=function(a,c,d){return a&&a.profilePicture?a.profilePicture.sizes&&c&&d?b.getPublicUrl("user/"+a.guid+"-"+b.getApproximateSize(c,d,a.profilePicture.sizes)+".png"):a.profilePicture.original:b.getPublicUrl("user/anonymous.png")},b.getImageUrl=function(a,c,d){if(a&&a.fileInformation){var e=b.getExtensionByMimeType(a.mimeType);return a.fileInformation.sizes&&c&&d?b.getPublicUrl("image/"+a.guid+"-"+b.getApproximateSize(c,d,a.fileInformation.sizes)+"."+e):a.fileInformation.original}throw new Error("Entity contains no image information: "+a.guid)},b}a.$inject=["Settings"],angular.module("angular-utilities").service("Resource",a)}(),angular.module("angular-utilities").run(["$templateCache",function(a){"use strict";a.put("templates/objectimage.html",'<img data-ng-src="{{type == \'user\' ? resource.getProfilePictureUrl(object, width, height) : resource.getImageUrl(object, width, height)}}"\r\n     data-ng-attr-height="{{height}}"\r\n     data-ng-attr-width="{{width}}"\r\n'+"     class=\"{{type == 'user' ? 'profile-picture' : 'object-image'}} {{class}}\" />")}]);